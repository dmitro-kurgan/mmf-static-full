function checkURLcontains(a){return window.location.href.indexOf(a)>-1}function addToCart(a,b){return $(".hide-cart .outofstock a[onclick=\"addToCart('"+a+"');\"]").length?!1:(b="undefined"!=typeof b?b:1,cart.add(a,b))}function addToWishList(a){return wishlist.add(a)}var Croomgsys={};Croomgsys.showNotification=function(a,b){$.pnotify.defaults.history=!1;var d=$("<div>"+a+"</div>"),e=d.find("a").first().attr("href"),f=b?'<a href="'+e+'"><img src="'+b+'" alt="" /></a>':"",g=d.find("a").last().prev(),h=1e3,i=$;return i.pnotify({title:g.html(),delay:parseInt(h,10),text:f+"<p>"+a+"</p>",type:"success",history:!1,width:"600px"}),$(".ui-pnotify-text a").die("click touchend").live("click touchend",function(){var a=$(this),b=a.attr("href");location=b}),!0},Croomgsys.searchAutoComplete=function(){$("#search input").autocomplete2({appendTo:".croomgsys-search > div",width:"100%",serviceUrl:"index.php?route=croomgsys2/search",deferRequestBy:500,paramName:"search",onSelect:function(a){return a.url?void(location=a.url):!1},transformResult:function(a){a=$.parseJSON(a);var b=$.map(a.results,function(a){return{value:a.name,data:a,image:a.image,price:a.price,special:a.special,url:a.url}});return b.push(a.view_more_url?{view_more:!0,value:a.view_more_text,url:a.view_more_url}:{view_more:!0,value:a.view_more_text,url:a.view_more_url}),{suggestions:b}},formatResult:function(a){if(a.view_more)return a.url?'<a class="view-more-link" href="'+a.url+'">'+a.value+"</a>":'<a class="no-results">'+a.value+"</a>";var c=a.value,d='<a href="'+a.url+'">';return a.image&&(d+='<span class="p-image xs-33 sm-33 md-33 lg-33 xl-33"><img src="'+a.image+'" /></span>'),d+='<span class="p-name xs-66 sm-66 md-66 lg-66 xl-66"><span>'+c+"</span>",a.price&&(d+=a.special?'<span class="p-price xs-66 sm-66 md-66 lg-66 xl-66"><span class="price-old">'+a.price+'</span><span class="price-new">'+a.special+"</span></span>":'<span class="p-price xs-66 sm-66 md-66 lg-66 xl-66">'+a.price+"</span>"),d+="</span>",d+='<div class="clearfix"> </div>',d+="</a>"}})},cart.add=function(a,b,c){return $(".hide-cart .outofstock a[onclick=\"cart.add('"+a+"');\"]").length?!1:(c="undefined"!==typeof c?c:{},c.product_id=a,c.quantity="undefined"!=typeof b?b:1,void $.ajax({url:"index.php?route=checkout/cart/add",type:"post",data:c,dataType:"json",success:function(a){a.redirect&&(location=a.redirect),a.success&&(Croomgsys.showNotification(a.success,a.image,!0),$("html, body").animate({scrollTop:0},"slow"),$(".cart_products_list").load("index.php?route=common/cart/info .cart_content",function(){$("#cart-total").html($(".cart_products_list tbody tr").length)}))}}))},cart.update=function(a,b){$(".cart-tr-"+a).fadeTo("slow",.33),$.ajax({url:"index.php?route=checkout/cart/edit",type:"post",data:"quantity["+a+"]="+("undefined"!=typeof b?b:1),dataType:"json",complete:function(){"checkout/cart"==getURLVar("route")||"checkout/checkout"==getURLVar("route")?location="index.php?route=checkout/cart":$(".cart_products_list").load("index.php?route=common/cart/info .cart_content",function(){$("#cart-total").html($(".cart_products_list tbody tr").length)})}})},cart.remove=function(a){$.ajax({url:"index.php?route=checkout/cart/remove",type:"post",data:"key="+a,dataType:"json",success:function(){$(".cart-tr-"+a).fadeOut(500),checkURLcontains("checkout/cart")||checkURLcontains("checkout/checkout")||checkURLcontains("checkout/buy")?location="index.php?route=checkout/buy":$(".cart_products_list").load("index.php?route=common/cart/info .cart_content",function(){$("#cart-total").html($(".cart_products_list tbody tr").length)})}})},wishlist.add=function(a){$.ajax({url:"index.php?route=account/wishlist/add",type:"post",data:"product_id="+a,dataType:"json",success:function(a){a.success&&Croomgsys.showNotification(a.success,a.image),a.info&&Croomgsys.showNotification(a.info,a.image);try{$("#wishlist_products_list").load("index.php?route=account/wishlist .products_list")}catch(b){}$("html, body").animate({scrollTop:0},"slow")}})},wishlist.remove=function(a){$.ajax({url:"index.php?route=account/wishlist",type:"get",data:"remove="+a,dataType:"json",complete:function(){$("#wishlist-tr-"+a).fadeOut(500),"account/wishlist"==getURLVar("route")?location="index.php?route=account/wishlist":$("#wishlist_products_list").load("index.php?route=account/wishlist .products_list")}})},Croomgsys.SuperFilter={},Croomgsys.SuperFilter.firstLoad=!0,Croomgsys.SuperFilter.init=function(a){a.find(".sf-reset").live("click",function(){Croomgsys.SuperFilter.reset(a)}),a.find('input[type="checkbox"]').live("click",function(){var b=$(this).closest(".box");b.hasClass("sf-single")&&b.find('input[type="checkbox"]').not($(this)).removeAttr("checked"),setTimeout(function(){Croomgsys.SuperFilter.filter(a)},1)}),$.address.change(function(b){(!Croomgsys.SuperFilter.firstLoad||Croomgsys.SuperFilter.firstLoad&&$(location).attr("hash").replace("#/","").replace("#",""))&&Croomgsys.SuperFilter.doFilter(a,b.value),Croomgsys.SuperFilter.firstLoad=!1}),$(function(){$("ul.cities_list_catalog li, ul.cities_list_number li").click(function(){setTimeout(function(){Croomgsys.SuperFilter.filter(a)},100)}),$(".blog-pagination__wrapper").removeClass("hide"),$(".blog-pagination__wrapper ul a").live("click",function(){return a.find(".sf-page").val(/*$(this).attr("href").split("page=")[1] указываем, что ?page= в ссылках больше нет*/$(this).attr("href").split("/")[$(this).attr("href").split("/").length-1]),Croomgsys.SuperFilter.filter(a),$("html, body").animate({scrollTop:0},700),!1})}),Croomgsys.SuperFilter.priceSlider(a)},Croomgsys.SuperFilter.reset=function(){var b=window.location.href;b=b.split("#"),window.location.href=b[0]},Croomgsys.SuperFilter.filter=function(a){var b={};a.find(".box").not(".sf-tags").not(".sf-availability").find("input:checked").each(function(){var a=$(this).attr("name");b[a]=b[a]||{name:a,group:a.replace(/\D/g,""),filters:[]},b[a].filters.push({keyword:$(this).attr("data-keyword"),value:$(this).val()})});var c=[];for(var d in b){var e=[],f=[],g=b[d].name[0],h=b[d].group;for(var i in b[d].filters)e.push(b[d].filters[i].keyword),f.push(b[d].filters[i].value);c.push(e.join(",")+"-"+(h?""+g+h+"-v":g)+f.join(","))}var j=[];a.find(".sf-tags").find("input:checked").each(function(){j.push($(this).val())}),j.length&&c.push(j.join(",")+"-tags");var k=[];if(a.find(".sf-availability").find("input:checked").each(function(){k.push($(this).val())}),k.length&&c.push("availability="+k.join(",")),$(".delivery_list_catalog span").attr("data-value")){var l=$(".delivery_list_catalog span").attr("data-value").split("sort=")[1].split("&");c.push("sort="+l[0]),c.push("order="+l[1].replace("order=",""))}if($(".delivery_list_number span").attr("data-value")){var l=$(".delivery_list_number span").attr("data-value").split("limit=")[1].split("&");c.push("limit="+l[0])}if(a.find(".sf-price").length>0)if(a.find(".sf-price").hasClass("sf-input"))c.push("minPrice="+a.find(".min-price").val()),c.push("maxPrice="+a.find(".max-price").val());else{var m=a.find(".sf-price"),n=a.find(".sf-price .slider").attr("data-min")||a.find(".sf-price .slider").attr("data-min-value"),o=a.find(".sf-price .slider").attr("data-max")||a.find(".sf-price .slider").attr("data-max-value");n&&o&&(n!=m.attr("data-min-price")||o!=m.attr("data-max-price"))&&(c.push("minPrice="+n),c.push("maxPrice="+o))}var p=a.find(".sf-page").val();/*alert(p);*/p&&c.push("page="+p),$.address.value(c.join("/"))},Croomgsys.SuperFilter.doFilter=function(a,b){var c={filters:b,route:a.attr("data-route"),path:a.attr("data-path"),manufacturer_id:a.attr("data-manufacturer"),search:a.attr("data-search"),tag:a.attr("data-tag")};$("input#description").length&&(c.description=$("input#description").is(":checked")?1:0),$(".blog-pagination__wrapper").addClass("hide"),$(".sf-loader").remove(),$(".main-products.product-list, .main-products.product-grid").append('<div class="sf-loader"><span>'+a.attr("data-loading-text")+"</span></div>"),$.ajax({url:a.attr("data-filters-action"),type:"post",async:!1,data:c,success:function(c){a.html($(c.replace(/\n/g," ")).html()),Croomgsys.SuperFilter.setFilters(a,b)}}),$.ajax({url:a.attr("data-products-action"),type:"post",data:c,success:function(a){var b=$("<div>"+a.replace(/\n/g," ")+"</div>");$(".content-wrapper__blocks").html(b.find(".product-list").html()),0==$(".product-list").length&&0==$(".product-grid").length&&$("#content .content:eq(1)").replaceWith(b.html()),$(".blog-pagination__wrapper").length>0?$(".blog-pagination__wrapper").html(b.find(".blog-pagination__wrapper").html()):($(".blog-pagination__wrapper").after(b.find(".blog-pagination__wrapper").html()),$(".blog-pagination__wrapper").after(b.find(".blog-pagination__wrapper").html())),$(".blog-pagination__wrapper").removeClass("hide"),Croomgsys.SuperFilter.setNavigation()}})},Croomgsys.SuperFilter.setFilters=function(a,b){var c=/-c(((\d+)(,*))+)$/,d=/-m(((\d+)(,*))+)$/,e=/-a(\d*)-v/,f=/-o(\d*)-v/,g=/(.+)-tags/,h=/availability=(.+)/,i=null,j=null,k=Math.floor(parseFloat(a.find(".sf-price").attr("data-min-price"))),l=Math.ceil(parseFloat(a.find(".sf-price").attr("data-max-price")));$.each(b.split("/"),function(b,m){if(c.test(m)){var n=m.split(c);return void $.each(n[1].split(","),function(b,c){a.find('.sf-category input[value="'+c+'"]').attr("checked","checked")})}if(d.test(m)){var n=m.split(d);return void $.each(n[1].split(","),function(b,c){a.find('.sf-manufacturer input[value="'+c+'"]').attr("checked","checked")})}if(e.test(m)){var n=m.split(e);return void $.each(n[2].split(","),function(b,c){a.find(".sf-attribute-"+n[1]+' input[value="'+c+'"]').attr("checked","checked")})}if(f.test(m)){var n=m.split(f);return void $.each(n[2].split(","),function(b,c){a.find(".sf-option-"+n[1]+' input[value="'+c+'"]').attr("checked","checked")})}if(g.test(m)){var n=m.split(g);return void $.each(n[1].split(","),function(b,c){a.find('.sf-tags input[value="'+c+'"]').attr("checked","checked")})}if(h.test(m)){var n=m.split(h);return void $.each(n[1].split(","),function(b,c){a.find('.sf-availability input[value="'+c+'"]').attr("checked","checked")})}return-1!==m.indexOf("limit=")?void $('.limit select option[value$="'+m+'"]').attr("selected","selected"):-1!==m.indexOf("sort=")?void(i=m):-1!==m.indexOf("order=")?void(j=m):-1!==m.indexOf("minPrice=")?void(k=m.replace("minPrice=","")):-1!==m.indexOf("maxPrice=")?void(l=m.replace("maxPrice=","")):void 0}),k&&l&&(a.find(".sf-price").hasClass("sf-input")?(a.find(".min-price").val(k),a.find(".max-price").val(l)):(a.find(".slider").attr("data-min-value",k),a.find(".slider").attr("data-max-value",l))),setTimeout(function(){Croomgsys.SuperFilter.priceSlider(a)},0),a.find("input:checked").each(function(){$(this).closest("label").addClass("sf-checked")})},Croomgsys.SuperFilter.collision=function(a,b){if(!a.length||b.length)return!1;var c=a.offset().left,d=40,e=c+d,f=b.offset().left,g=40,h=f+g;return!(e<f||c>h)},Croomgsys.SuperFilter.price=function(a,b){var c=a.attr("data-currency-left"),d=a.attr("data-currency-right"),e=a.attr("data-currency-decimal"),f=a.attr("data-currency-thousand");return b=b.toString().replace(".",e).replace(/\B(?=(\d{3})+(?!\d))/g,f),c?c+b:b+d},Croomgsys.SuperFilter.priceSlider=function(a){return a.find(".sf-price").hasClass("sf-input")?(a.find(".price-filter-button").click(function(){Croomgsys.SuperFilter.filter(a)}),void a.find(".min-price,.max-price").keydown(function(b){13==b.keyCode&&Croomgsys.SuperFilter.filter(a)})):(a.find(".slider").slider({range:!0,min:Math.floor(parseFloat(a.find(".sf-price").attr("data-min-price"))),max:Math.ceil(parseFloat(a.find(".sf-price").attr("data-max-price"))),values:[parseFloat(a.find(".slider").attr("data-min-value")),parseFloat(a.find(".slider").attr("data-max-value"))],slide:function(b,c){$(".ui-slider-handle:eq(0) .price-range-min").html(Croomgsys.SuperFilter.price(a,c.values[0])),$(".ui-slider-handle:eq(1) .price-range-max").html(Croomgsys.SuperFilter.price(a,c.values[1])),$(".price-range-both").html("<i>"+Croomgsys.SuperFilter.price(a,c.values[0])+" - </i>"+Croomgsys.SuperFilter.price(a,c.values[1])),c.values[0]==c.values[1]?$(".price-range-both i").css("display","none"):$(".price-range-both i").css("display","inline"),1==Croomgsys.SuperFilter.collision($(".price-range-min"),$(".price-range-max"))?($(".price-range-min, .price-range-max").css("opacity","0"),$(".price-range-both").css("display","block")):($(".price-range-min, .price-range-max").css("opacity","1"),$(".price-range-both").css("display","none")),$("#minCost").val(c.values[0]),$("#maxCost").val(c.values[1])},change:function(b,c){$(this).attr("data-min",c.values[0]),$(this).attr("data-max",c.values[1]),$("#minCost").val(c.values[0]),$("#maxCost").val(c.values[1]),Croomgsys.SuperFilter.filter(a)}}),jQuery("input#minCost").change(function(){var b=jQuery("input#minCost").val(),c=jQuery("input#maxCost").val();parseInt(b)>parseInt(c)&&(b=c,jQuery("input#minCost").val(b)),a.find(".slider").slider("values",0,b)}),jQuery("input#maxCost").change(function(){var b=jQuery("input#minCost").val(),c=jQuery("input#maxCost").val();c>1e4&&(c=1e4,jQuery("input#maxCost").val(1e4)),parseInt(b)>parseInt(c)&&(c=b,jQuery("input#maxCost").val(c)),a.find(".slider").slider("values",1,c)}),jQuery("input#minCost, input#maxCost").keypress(function(a){var b,c;if(!a)var a=window.event;return a.keyCode?b=a.keyCode:a.which&&(b=a.which),null==b||0==b||8==b||13==b||9==b||46==b||37==b||39==b?!0:(c=String.fromCharCode(b),/\d/.test(c)?void 0:!1)}),$(".ui-slider-range").append('<span class="price-range-both value"><i>'+Croomgsys.SuperFilter.price(a,a.find(".slider").slider("values",0))+" - </i>"+Croomgsys.SuperFilter.price(a,a.find(".slider").slider("values",1))+"</span>"),$("#minCost").val(a.find(".slider").slider("values",0)),$("#maxCost").val(a.find(".slider").slider("values",1)),$(".price-range-min").html()===$(".price-range-max").html()?$(".price-range-both i").css("display","none"):$(".price-range-both i").css("display","inline"),void(1==Croomgsys.SuperFilter.collision($(".price-range-min"),$(".price-range-max"))?($(".price-range-min, .price-range-max").css("opacity","0"),$(".price-range-both").css("display","block")):($(".price-range-min, .price-range-max").css("opacity","1"),$(".price-range-both").css("display","none"))))},Croomgsys.SuperFilter.setNavigation=function(){},Croomgsys.blogSearch=function(a,b){a.find("a").click(function(){var c=encodeURIComponent(a.find("input").val());return c?void(parent.window.location=b+c):!1}),a.find("input").keydown(function(c){if(13==c.keyCode){var d=encodeURIComponent(a.find("input").val());if(!d)return!1;parent.window.location=b+d}})},$(document).ready(function(){$(".super-menu > li").each(function(a){$(this).addClass("main-menu-item-"+(a+1))}),$(".croomgsys-links .links > a").each(function(a){$(this).addClass("top-menu-item-"+(a+1))}),$(".croomgsys-secondary .links > a").each(function(a){$(this).addClass("secondary-menu-item-"+(a+1))})});